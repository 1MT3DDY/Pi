{% extends "layouts/base.html" %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Pregunta {{ idx|add:1 }} de {{ total }}</h2>
    
    <!-- Score Display -->
    <div class="card mb-4 bg-light">
        <div class="card-body">
            <h6 class="card-subtitle mb-2 text-muted">Puntuaci√≥n Actual</h6>
            <h4 class="card-title">{{ current_score }} puntos</h4>
            <div class="progress">
                <div class="progress-bar" role="progressbar" style="width: {{ progress_percent }}%;" aria-valuenow="{{ idx|add:1 }}" aria-valuemin="0" aria-valuemax="{{ total }}"></div>
            </div>
            <small class="text-muted">Progreso: {{ idx|add:1 }} de {{ total }} preguntas</small>
        </div>
    </div>

    <form method="post">
        {% csrf_token %}
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">{{ pregunta.pregunta }}</h5>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="respuesta" id="opt1" value="1" {% if selected == '1' %}checked{% endif %} required>
                    <label class="form-check-label" for="opt1">Conservador ({{ pregunta.respuesta_1 }} puntos)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="respuesta" id="opt2" value="2" {% if selected == '2' %}checked{% endif %}>
                    <label class="form-check-label" for="opt2">Moderado ({{ pregunta.respuesta_2 }} puntos)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="respuesta" id="opt3" value="3" {% if selected == '3' %}checked{% endif %}>
                    <label class="form-check-label" for="opt3">Arriesgado ({{ pregunta.respuesta_3 }} puntos)</label>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-between">
            {% if idx > 0 %}
            <a href="{% url 'quiz_question' idx=idx|add:"-1" %}" class="btn btn-secondary">Anterior</a>
            {% else %}
            <a href="{% url 'index' %}" class="btn btn-light">Cancelar</a>
            {% endif %}

            <button type="submit" class="btn btn-primary">{% if idx|add:"1" == total %}Enviar respuestas{% else %}Siguiente{% endif %}</button>
        </div>
    </form>
</div>
{% endblock %}
